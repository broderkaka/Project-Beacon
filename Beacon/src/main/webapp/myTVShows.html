<html>
<head>
<script>
 $(function() {
$( "#accordion-shows" ).accordion({
    collapsible: true
});
});


    function fetchMyShows() {
        jQuery.ajax({
        url: "/rest/v1/getmytvshows",
        type: 'get',
        dataType: 'json',
        success:function(data)
        {
            for(var i in data)
            {
                console.log(data[i]);
                var newDiv = '<div><img src='+data[i].show_banner[0]+ ' style="max-width:100%;max-height:100%;"></div>';
                newDiv += '<div class="acco-'+data[i].show_id+'">';
                for(var s in data[i].show_seasons)
                {
                    newDiv += getSeasonDiv(data[i].show_seasons[s]);
                }
                $('.MyShows').append(newDiv)
                $('.acco-'+data[i].show_id).accordion({
                    collapsible: true
                });


                 $('.acco-'+data[i].show_id).accordion("refresh");
                 $('.MyShows').accordion("refresh");
            }
        }
     });
    }

    $( ".MyShows" ).tabs({
   load: fetchMyShows()
});


function getSeasonDiv(season)
{
    var seasonDiv = '<div>';

        seasonDiv += 'Season ' + season.season_number;

    seasonDiv += '</div><div><table>';
    if(season.season_banner.length != 0)
    {
        seasonDiv += '<tr><td>';
        seasonDiv += '<img src='+season.season_banner[0]+ ' style="max-width:100%;max-height:100%;">';
        seasonDiv += '</td></tr>'
    }
    var episodes = season.season_episodes
    for (var i in episodes)
    {
        seasonDiv += '<tr><td>';
        seasonDiv += episodes[i].episode_number;
        seasonDiv += ' : ';
        seasonDiv += episodes[i].episode_name;
        seasonDiv += '</td></tr>';
    }
    seasonDiv += '</table></div>';
    return seasonDiv;
}


</script>
</head>
<body>
</div>
<div class="MyShows" id="accordion-shows">
</div>
</body>
</html>